Suvanth has just finished his AP CSA assignment about Dijkstra's algorithm and his teacher was impressed. His teacher told him to find the minimum path between pairs of nodes in the graph but with a catch: The cost of a path is the XOR over all (non-distinct) edge weights in the path.
<br><br>
Suvanth found this problem to be extremely easy, so he solved this harder version of the problem.
<br><br>
There are $N$ nodes in a graph with no edges between them. There are $Q$ queries you must compute. Each query is either type 1 or type 2.
<br><br>
Type 1 queries add an edge from nodes $a$ to $b$ of weight $w$.
<br><br>
Type 2 queries ask you to compute the minimum cost of a path between nodes $a$ and $b$ where the cost is defined as the bitwise xor of all edge weights on the path. If an edge appears multiple times on a path, it is XOR'd as many times as it appears. If no path exists, output $-1$.
<br>
<h3>Input</h3>
The first line is 2 integers $N$, $Q$ $(1 \le N \le 10^5, 1 \le Q \le 10^6)$.
<br><br>
The next Q lines contain queries of type either 1 or 2.
<br><br>
Type 1 queries are in the form of $1$ $a$ $b$ $w$ $(1 \le a,b \le N, 0 \le w < 2^{31})$.
<br><br>
Type 2 queries are in the form of $2$ $a$ $b$ $(1 \le a,b \le N)$.
<br><h3>Output</h3>
For all queries of type 2, output the minimum cost path or $-1$ if no path exists.
<br><br>
<b>Sample Input</b><br>
<codeblock>5 5
1 1 2 1
1 2 3 4
1 2 3 1
1 3 5 2
2 1 5
</codeblock>
<b>Sample Output</b><br>
<codeblock>2</codeblock>
The minimum cost is going through the edges
<br><br>
1 $\rightarrow$ 2 weight: 1
<br><br>
2 $\rightarrow$ 3 weight: 1
<br><br>
3 $\rightarrow$ 5 weight: 2
<br><br>
$1 \oplus 1 \oplus 2=2$
<br><br>
It can be proved that this is the optimal solution
<br><br>
Subtask 1: $N \le 10^3$, $Q \le 2\cdot 10^3$
<br>
Subtask 2: The graph will not contain cycles
<br>
Subtask 3: All the queries of type 2 will happen after all queries of type 1
<br>
Subtask 4: No additional constraints